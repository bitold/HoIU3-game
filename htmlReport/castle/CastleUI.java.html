<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CastleUI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">LAB1 Coverage Results</a> &gt; <a href="index.source.html" class="el_package">castle</a> &gt; <span class="el_source">CastleUI.java</span></div><h1>CastleUI.java</h1><pre class="source lang-java linenums">package castle;

import asset.Hero;
import classification.ShopBuildingClassificator;
import classification.UnitClassificator;
import menus.BuyingMenu;
import player.Player;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Objects;
import java.util.Scanner;


public class CastleUI implements Serializable {
    private Castle castle;
    private Hero hero;
    BuyingMenu buyingMenu;

    // Списки, наполненные товарами и использующиеся при выводе меню.
<span class="nc" id="L22">    private ArrayList&lt;ShopBuildingClassificator&gt; buildings = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L23">    private ArrayList&lt;UnitClassificator&gt; units = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L25">    CastleUI(Castle castle){</span>
<span class="nc" id="L26">        this.castle=castle;</span>
<span class="nc" id="L27">        initializeShop();</span>
<span class="nc" id="L28">        buyingMenu = new BuyingMenu(castle, this);</span>
<span class="nc" id="L29">    }</span>

    public ArrayList&lt;ShopBuildingClassificator&gt; getBuildings() {
<span class="nc" id="L32">        return buildings;</span>
    }

    public ArrayList&lt;UnitClassificator&gt; getUnits() {
<span class="nc" id="L36">        return units;</span>
    }

    public boolean checkUnitAvailability(UnitClassificator unit){
<span class="nc bnc" id="L40" title="All 2 branches missed.">        for (ShopBuildingClassificator building: castle.getBuildings()){</span>
<span class="nc bnc" id="L41" title="All 4 branches missed.">            if (!Objects.isNull(building.getUnit()) &amp;&amp; building.getUnit().equals(unit)){</span>
<span class="nc" id="L42">                return true;</span>
            }
<span class="nc" id="L44">        }</span>
<span class="nc" id="L45">        return false;</span>
    }

    public void startShop(){
<span class="nc" id="L49">        buyingMenu.engageShopMenu();</span>
<span class="nc" id="L50">        leaveCastle();</span>
<span class="nc" id="L51">    }</span>

    // Класс, представляющиЙ товары в магазине.
   /* public static class Item {
        private int id;
        private String name;
        private int price;
        private String type; // &quot;building&quot; или &quot;unit&quot;
        public Item(int id, String name, String type, int price){
            this.id = id;
            this.name = name;
            this.price = price;
            this.type = type;
            fillUnitBuildingMap();
        }
        public Item(int id, String name, String type) {
            this.id = id;
            this.name = name;
            this.price = UnitClassificator.getCostByName(name);
            this.type = type;
            fillUnitBuildingMap();
        }
        String[][] unitBuildingMatrix = {{&quot;Копейщик&quot;, &quot;Арбалетчик&quot;, &quot;Мечник&quot;, &quot;Кавалерист&quot;, &quot;Паладин&quot;},
                {&quot;Сторожевой пост&quot;, &quot;Башня арбалетчиков&quot;, &quot;Оружейная&quot;, &quot;Арена&quot;, &quot;Собор&quot;}};
        HashMap&lt;String, String&gt; unitToBuildingMap = new HashMap&lt;&gt;();
        void fillUnitBuildingMap(){
            for (int i = 0; i &lt; unitBuildingMatrix[0].length; i++) {
                String unit = unitBuildingMatrix[0][i];
                String building = unitBuildingMatrix[1][i];
                unitToBuildingMap.put(unit, building);
            }
        }
        public int getPrice() {
            return price;
        }

        public int getId() {
            return id;
        }

        public String getName() {
            return name;
        }

        boolean available(Castle castle){
            if (type == &quot;building&quot;){
                return true;
            } else {
                String requiredBuilding = unitToBuildingMap.get(this.name);
                System.out.println(&quot;Для юнита \&quot;&quot; + this.name + &quot;\&quot; требуется строение: &quot; + requiredBuilding);
                return castle.isBuilding(requiredBuilding);
            }
        }
    }*/


    void initializeShop(){
<span class="nc" id="L108">        int i = 0;</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">        for (ShopBuildingClassificator building : ShopBuildingClassificator.values()) {</span>
<span class="nc" id="L110">            buildings.add(i, building);</span>
<span class="nc" id="L111">            i++;</span>
        }
<span class="nc" id="L113">        i = 0;</span>

<span class="nc bnc" id="L115" title="All 2 branches missed.">        for (UnitClassificator unit : UnitClassificator.values()) {</span>
<span class="nc" id="L116">            units.add(i, unit);</span>
<span class="nc" id="L117">            i++;</span>
        }
<span class="nc" id="L119">        i = 0;</span>

<span class="nc" id="L121">    }</span>

    public void enterCastle(Hero hero){
<span class="nc" id="L124">        this.hero = hero;</span>
<span class="nc" id="L125">    }</span>

    public void leaveCastle(){
<span class="nc" id="L128">        this.hero = null;</span>
<span class="nc" id="L129">    }</span>

    public Hero getHero() {
<span class="nc" id="L132">        return hero;</span>
    }

    public void buyBuilding(ShopBuildingClassificator building){
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if (castle.getOwner().getGold() &gt; building.getCost()){</span>
<span class="nc" id="L137">            castle.build(building);</span>
<span class="nc" id="L138">            castle.getOwner().takeGold(building.getCost());</span>
<span class="nc" id="L139">            buyingMenu.printBuildingBought(building);</span>
        }
        else {
<span class="nc" id="L142">            buyingMenu.printNotEnoughGold();</span>
        }
<span class="nc" id="L144">    }</span>
    public void buyUnit(UnitClassificator unit, Hero hero){
<span class="nc bnc" id="L146" title="All 4 branches missed.">        if (castle.getOwner().getGold() &gt; unit.getCost() &amp;&amp; checkUnitAvailability(unit)){</span>
<span class="nc" id="L147">            hero.addUnit(UnitClassificator.createUnit(unit, hero));</span>
<span class="nc" id="L148">            castle.getOwner().takeGold(unit.getCost());</span>
<span class="nc" id="L149">            buyingMenu.printUnitBought(unit);</span>
        }
<span class="nc bnc" id="L151" title="All 2 branches missed.">        else if (castle.getOwner().getGold() &lt; unit.getCost()) {</span>
<span class="nc" id="L152">            buyingMenu.printNotEnoughGold();</span>
        }
<span class="nc bnc" id="L154" title="All 2 branches missed.">        else if (checkUnitAvailability(unit)){</span>
<span class="nc" id="L155">            buyingMenu.printNoRequiredBuilding();</span>
        }
<span class="nc" id="L157">    }</span>

    public void buyHero(Hero hero) {
<span class="nc bnc" id="L160" title="All 2 branches missed.">        if (castle.getOwner().getGold() &lt; 100){</span>
<span class="nc" id="L161">            buyingMenu.printNotEnoughGold();</span>
<span class="nc" id="L162">            return;</span>
        }
<span class="nc" id="L164">        castle.getOwner().addHero(hero);</span>
<span class="nc" id="L165">        castle.getOwner().takeGold(100);</span>
<span class="nc" id="L166">        castle.getMap().spawn(hero);</span>
<span class="nc" id="L167">        buyingMenu.printHeroBought();</span>
<span class="nc" id="L168">    }</span>
/*    public boolean processPurchase(Player player, Scanner scanner) {
        System.out.println(&quot;Что вы хотите купить? (B - Строение; U - юнит; C - выйти из магазина)&quot;);
        String type = scanner.nextLine();
        System.out.println(type + &quot; Проверяю выход из магазина...&quot;);
        if (Objects.equals(type, &quot;C&quot;)){
            System.out.println(&quot;Выхожу из магазина&quot;);
            return false;
        }
        System.out.println(&quot;Введите номер из списка:&quot;);
        int num;
        int heroNum;
        try {
            num = Integer.parseInt(scanner.nextLine());
        } catch (Exception e) {
            System.out.println(&quot;Ошибка. Попробуйте снова.&quot;);
            return true;
        }
        if (type.equalsIgnoreCase(&quot;B&quot;)) {
            buyBuilding(num);
        } else if (type.equalsIgnoreCase(&quot;U&quot;)) {
            System.out.println(&quot;Введите номер героя, который получит юнита.&quot;);
            try {
                heroNum = Integer.parseInt(scanner.nextLine());
            } catch (Exception e) {
                System.out.println(&quot;Ошибка. Попробуйте снова.&quot;);
                return true;
            }
            buyUnit(num, heroNum);
        } else {
            System.out.println(&quot;Неверный тип покупки.&quot;);
        }
        return true;
    }*/
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>